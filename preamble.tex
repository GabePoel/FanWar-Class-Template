\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[
    top    = 0.5 in,
    bottom = 1.5 in,
    left   = 0.5 in,
    right  = 0.5 in,
    footskip = 72 pt]{geometry}
\usepackage[table]{xcolor}
\usepackage{array}
\usepackage{fontspec}
\usepackage{multicol}
\usepackage{graphicx}
\usepackage[T1]{fontenc}
\usepackage[outline]{contour}
\usepackage{titlesec}
\usepackage{ragged2e}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{etoolbox}
\usepackage{arydshln}
\usepackage[abspath]{currfile}

\setlength{\dashlinedash}{.5pt}
\setlength{\dashlinegap}{5pt}

\graphicspath{ {./images/} }
\setmainfont{Main}[
    Path           = fonts/ ,
    UprightFont    = *-Regular.ttf ,
    BoldFont       = *-Bold.ttf ,
    ItalicFont     = *-Italic.ttf ,
    BoldItalicFont = *-BoldItalic.ttf
]
\newfontfamily{\texthf}{Headers}[
    Path      = fonts/ ,
    Extension = .ttf
]
\definecolor{gray0}{gray}{0.9}
\definecolor{gray1}{gray}{1}
\definecolor{gray2}{gray}{0.95}
\definecolor{gray3}{gray}{0.2}
\renewcommand{\arraystretch}{1.25}
\contourlength{1pt}
\contournumber{10}

\titleformat*{\section}
{\texthf\Huge}
\titlespacing{\section}{0pt}{\baselineskip}{0.625\baselineskip}
\titleformat*{\subsection}
{\texthf\Large}
\titleformat*{\subsubsection}
{\texthf\large}

\pagestyle{fancy}
\renewcommand{\headrulewidth}{0pt}
\fancyhf{}
\lfoot{Page \thepage\ of \pageref{last}}
\rfoot{\includegraphics[height = 0.5in]{images/Logo.png}}

\newcounter{rank}[section]
\newenvironment{newrank}[1]{\refstepcounter{rank}\subsection*{\color{gray3}{\contour{gray3}{Rank \therank \ Abilities}}}
    \vspace{-10pt}
    \hrule
    \vspace{2pt}
    #1}

% Defines a new section with a custom style
% Use this at the start of the class
\newcommand\newclass[2]{
    \section*{\color{gray3}{\contour{gray3}{#1}}\setcounter{rank}{0}}
    \noindent#2 \\
}

% Defines a new subsubsection with a custom style
% Use this for abilities
\newcommand\newability[5][\hdashline]{
    \vbox{
        \subsubsection*{\color{gray3}{\contour{gray3}{#2} \hfill Rank \therank\vspace{-6 pt}}}
        \noindent
        \textit{#3} \hfill \textit{#4}\vspace{5 pt}\\
        \noindent\justifying{#5} \\
        \vspace{-35 pt}
        \begin{tabular}{p{7.6cm}}
            \phantom{x} \\ #1
        \end{tabular}
        \vspace{-11 pt}
    }
}

% Defines a new table with a custom style
% Use this for class restrictions, prerequisites, etc.
\newcommand\spectable[2][Specs]{
    \hspace{-0.8cm}
    {\rowcolors{2}{gray1}{gray2}
        \begin{center}
            \begin{tabular}{ p{2.25cm} p{6cm} }
                \rowcolor{gray0}
                \multicolumn{2}{c}{\textbf{#1}} \\
                \hline
                #2
            \end{tabular}
        \end{center}}
    \vspace{1em}
}

% Defines a new command for including images with a custom style
% Use this for the class' art
\newcommand\newimage[2][3]{
    \Centering
    \includegraphics[height = #1 in]{#2} \vspace{1em}
}